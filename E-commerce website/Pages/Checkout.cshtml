@page
@model E_commerce_website.Pages.CheckoutModel
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] Smease12 Gifts</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/form.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/cart.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/checkout.css" asp-append-version="true" />
</head>

<body>

    @if(Model.ProductCount <= 0)
    {
        //redirect to cart if no products
        <script>
            window.location.href = '@Url.Page("Cart")';
        </script>
    }
    else{

    <div id="popupAddressForm" class="popup">
        <div class="popup-content">
            
            <form method="post" asp-page-handler="AddressForm">
                <div class="container">
                    <h3>Add a new address</h3>
                    <div class="row">
                        <div class="col-md-6">
                            <!--left column-->
                            <div class="form-group">
                                <label class="form-label" for="Country">Country/Region</label>
                                <input type="text" id="Country" asp-for="Country" />
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="FullName">Full name (First and Last name)</label>
                                <input type="text" id="FullName" asp-for="FullName" />
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="PhoneNumber">Phone number</label>
                                <input type="text" id="PhoneNumber" asp-for="PhoneNumber" />
                            </div>
                            <div class="form-group">
                                    <label class="form-label" for="Address1">Address</label>
                                    <input type="text" placeholder="Steet address or P.O. Box" id="Address1" asp-for="Address1" />
                                    <input type="text" placeholder="Apt, suite, unit, building, floor, etc." id="Address2" asp-for="Address2" />
                             </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label" for="City">City</label>
                                <input type="text" asp-for="City" id="City" />
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="State">State</label>
                                <input type="text" id="State" asp-for="State" />
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="ZipCode">ZIP Code</label>
                                <input type="number" asp-for="ZipCode" id="ZipCode" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <button class="btn" type="submit">Use this address</button>
                            </div>
                            <div class="col-md-6">
                            <button class="btn" id="closeAddressPopupButton">Close</button>
                            </div>
                    </div>
                    </div>
                    
            </form>

        </div>
    </div>

    <div style="width: 100%">

            <row class="border-bottom">
                <h2 id="displayCheckoutCount" class="product-brand">Checkout (@Model.ProductCount Items)</h2>
            </row>


        <form method="post" asp-page-handler="CheckoutForm" id="CheckoutForm" class="row">
            @Html.AntiForgeryToken()
            <div class="row">
            <div class="col-9 text-center align-items-center">
                <div class="row">
                    <div class="col-1 m-3">
                        <p class="product-sub-heading">1</p>
                    </div>
                    <div class="col-3 m-3">
                        <p class="product-sub-heading">Shipping address</p>
                    </div>
                    <div class="col-3 m-3">
                        <p style="margin:70px 0 10px;">@Model.Address1</p>
                        <p>@Model.Address2</p>
                        <p>@Model.City, @Model.State, @Model.ZipCode</p>
                    </div>
                    <div class="col-2 m-3">
                        <p style="margin:70px 0 10px;"><button class="link-button" id="openAddressPopupButton">Change</button></p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-1 m-3">
                        <p class="product-sub-heading">2</p>
                    </div>
                    <div class="col-3 m-3">
                        <p class="product-sub-heading">Payment method</p>
                    </div>
                    <div class="col-3 m-3">
                        <p style="margin:70px 0 10px;">Visa ending in 1234</p>
                    </div>
                    <div class="col-2 m-3">
                        <p style="margin:70px 0 10px;"><a href="">Change</a></p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-1 m-3">
                        <p class="product-sub-heading">3</p>
                    </div>
                    <div class="col-3 m-3">
                        <p class="product-sub-heading">Offers</p>
                    </div>
                    <div class="col-3 m-3">
                    </div>
                    <div class="col-2 m-3">
                        <p style="margin:70px 0 10px;"><a href="">Change</a></p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-1 m-3">
                        <p class="product-sub-heading">4</p>
                    </div>
                    <div class="col-3 m-3">
                        <p class="product-sub-heading">Review items and shipping</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-1 m-3"></div>
                    <div class="col-8 p-2 m-3 border">
                        <input type="hidden" asp-for="@Model.ProductCount" id="hiddenProductCount"/>
                        <input type="hidden" asp-for="@Model.ProductTypeCount" id="hiddenProductTypeCount"/>
                        @for (int i = 0; i < Model.Products.Count; i++)
                        {
                            <div class="row m-2">
                                <p>Delivery: @Model.Products[i].DeliveryDate </p>
                                <div class="col-3">
                                <a asp-page="/Product" asp-route-productId=@Model.Products[i].ProductId>
                                    <img style="height:100px; width:120px;" src="~/uploads/@Model.Products[i].ProductImg" />
                                </a>
                                </div>
                                <div class="col-6">
                                    <input type="hidden" asp-for="@Model.Products[i].ProductSellPrice" id="hiddenPrice_@Model.Products[i].ProductId" />
                                    <p style="margin:30px 0 10px;"><a asp-page="/Product" asp-route-productId="@Model.Products[i].ProductId">@Model.Products[i].ProductName</a></p>
                                    <p  id="priceDisplay_@Model.Products[i].ProductId"> $@Model.Products[i].OrderSellPrice</p>
                                    <select asp-for="@Model.Products[i].ProductQty" name="quantityDropdown_@Model.Products[i].ProductId" id="quantityDropdown_@Model.Products[i].ProductId" data-product-id="@Model.Products[i].ProductId" data-product-price="@Model.Products[i].ProductSellPrice">
                                        <option value="1">Qty: 1</option>
                                        <option value="2">Qty: 2</option>
                                        <option value="3">Qty: 3</option>
                                        <option value="4">Qty: 4</option>
                                        <option value="5">Qty: 5</option>
                                        <option value="6">Qty: 6</option>
                                        <option value="7">Qty: 7</option>
                                        <option value="8">Qty: 8</option>
                                        <option value="9">Qty: 9</option>
                                        <option value="10">Qty: 10</option>
                                    </select>
                                    |
                                    <button data-product-id="@Model.Products[i].UserCartId"
                                            class="delete-button"
                                            style="background: none;
                                                    border: none;
                                                    padding: 0;
                                                    margin: 0;
                                                    cursor: pointer;
                                                    color: black;
                                                    text-decoration: underline;">
                                        Delete
                                    </button>
                                </div>
                            </div>

                        }
                    </div>
                </div>
            </div>
            <div class="col-3" style="margin:70px 0 10px;">
                <p style="border-bottom: medium;">
                    <button type="submit" class="buttons" style="
                                padding: 10px 30px;
                                text-transform: capitalize;
                                color: #fff;
                                background: #383838;
                                border-radius: 5px;
                                border: none;
                                 outline: none;
                                 margin-right: 10px;
                                    cursor: pointer;">
                        Place Your Order
                    </button>
                </p>
                <p>
                    Order Summary
                </p>
                <input type="hidden" id="hiddenTotalSellPrice" asp-for="@Model.TotalPrice" />
                <p id="displayTotalSellPrice" data-total-before-tax="@Model.TotalPrice">
                    Items: $@Model.TotalPrice
                </p>
                <input type="hidden" id="hiddenShipping" asp-for="@Model.Shipping" />
                <p id="displayShipping">
                    Shipping/Handling: $@Model.Shipping
                </p>
                <input type="hidden" id="hiddenTotalBeforeTax" asp-for="@Model.TotalBeforeTax" />
                <p id="displayTotalBeforeTax">
                    Total before tax: $@Model.TotalBeforeTax
                </p>
                <input type="hidden" id="hiddenTax" asp-for="@Model.Tax" />
                <p id="displayTax">
                    Tax: $@Model.Tax
                </p>
                <input type="hidden" id="hiddenOrderTotal" asp-for="@Model.OrderTotal" />
                <p id="displayOrderTotal">
                    Order Total $@Model.OrderTotal
                </p>
            </div>
                </div>
        </form>

    </div>
    }
    
</body>


<!-- Include jQuery library -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="~/js/checkout.js"></script>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<partial name="_ValidationScriptsPartial" />

</html>
